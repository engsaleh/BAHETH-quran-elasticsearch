# ๐ ุชุทุจูู ุงูุจุญุซ ูู ุงููุฑุขู ุงููุฑูู

ุชุทุจูู ููุจ ูุชูุฏู ููุจุญุซ ูู ุงููุฑุขู ุงููุฑูู ุจุงุณุชุฎุฏุงู ุชูููุงุช ุงูุจุญุซ ุงููุบูู ูุงูุฏูุงููุ ูุจูู ุจู Flask ู Elasticsearch.

## โจ ุงููููุฒุงุช

- ๐ **ุซูุงุซุฉ ุฃููุงุน ูู ุงูุจุญุซ:**

 - **ูุบูู (Lexical)**: ุจุญุซ ุฏููู ูุทุงุจู ุงููููุงุช ูุงููุตูุต
 - **ุฏูุงูู (Semantic)**: ุจุญุซ ุฐูู ูููู ุงููุนุงูู ูุงูุณูุงู
 - **ูุฌูู (Hybrid)**: ูุฌูุน ุจูู ุงูููุนูู ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌ

- ๐จ **ูุงุฌูุฉ ูุณุชุฎุฏู ุนุตุฑูุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู**
- ๐ **ุฏุนู ูุงูู ููุบุฉ ุงูุนุฑุจูุฉ** ูุน ุงุชุฌุงู ูู ุงููููู ูููุณุงุฑ
- โก **ุฃุฏุงุก ุนุงูู** ูุน Elasticsearch
- ๐ฑ **ุชุตููู ูุชุฌุงูุจ** ูุนูู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
- ๐ข **ุนุฑุถ ุฏุฑุฌุฉ ุงูุฏูุฉ** ููู ูุชูุฌุฉ ุจุญุซ

## ๐ ุงููุชุทูุจุงุช

### ุงูุจุฑูุฌูุงุช ุงููุทููุจุฉ:

1. **Python 3.8+**
2. **Elasticsearch 8.x** (ูููู ุชุดุบููู ูุญููุงู ุฃู ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุณุญุงุจูุฉ)
3. **pip** ูุฅุฏุงุฑุฉ ุงูุญุฒู

## ๐ ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### ุงูุฎุทูุฉ 1: ุชุซุจูุช Elasticsearch

#### ุนูู Ubuntu/Debian:

```bash
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee /etc/apt/sources.list.d/elastic-8.x.list
sudo apt-get update && sudo apt-get install elasticsearch
```

#### ุนูู macOS:

```bash
brew tap elastic/tap
brew install elastic/tap/elasticsearch-full
```

#### ุนูู Windows:

ูู ุจุชุญููู ูุชุซุจูุช Elasticsearch ูู [ุงููููุน ุงูุฑุณูู](https://www.elastic.co/downloads/elasticsearch)

### ุงูุฎุทูุฉ 2: ุชุดุบูู Elasticsearch

```bash
# ุนูู Linux/macOS
sudo systemctl start elasticsearch

# ุฃู
elasticsearch

# ุชุญูู ูู ุงูุชุดุบูู
curl -X GET "localhost:9200"
```

### ุงูุฎุทูุฉ 3: ุชุญููู ุงููุดุฑูุน

```bash
# ุงุณุชูุณุฎ ุงููุดุฑูุน
git clone <repository-url>
cd quran-search-app

# ุฃูุดุฆ ุจูุฆุฉ ุงูุชุฑุงุถูุฉ
python -m venv venv

# ูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
# ุนูู Linux/macOS:
source venv/bin/activate

# ุนูู Windows:
venv\Scripts\activate
```

### ุงูุฎุทูุฉ 4: ุชุซุจูุช ุงููุชุทูุจุงุช

```bash
pip install -r requirements.txt
```

### ุงูุฎุทูุฉ 5: ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ุฃูุดุฆ ููู `.env` ูู ุงููุฌูุฏ ุงูุฑุฆูุณู:

```env
ES_URL=https://localhost:9200
ES_USER=elastic
ES_PASS=your_elasticsearch_password
ES_INDEX=quran_search_v1
```

**ููุงุญุธุฉ**: ุงุญุตู ุนูู ูููุฉ ุงููุฑูุฑ ูู ุฅุนุฏุงุฏุงุช Elasticsearch ุฃู ูู ููู ุงูุชุณุฌูู ุนูุฏ ุฃูู ุชุดุบูู.

### ุงูุฎุทูุฉ 6: ุชุญุถูุฑ ุงูุจูุงูุงุช

ุชุฃูุฏ ูู ูุฌูุฏ ููู `quran_data.csv` ูู ุงููุฌูุฏ ุงูุฑุฆูุณู ุจุงูุชูุณูู ุงูุชุงูู:

```csv
sura,aya,text,sura_name
1,1,ุจูุณููู ุงูููููู ุงูุฑููุญูููููฐูู ุงูุฑููุญูููู,ุงููุงุชุญุฉ
1,2,ุงููุญูููุฏู ููููููู ุฑูุจูู ุงููุนูุงููููููู,ุงููุงุชุญุฉ
...
```

ุฅุฐุง ูุงู ูุฏูู ููู XMLุ ููููู ุงุณุชุฎุฏุงู:

```bash
python prepare_quran_data.py
```

### ุงูุฎุทูุฉ 7: ุฅูุดุงุก ุงูููุฑุณ ูููุฑุณุฉ ุงูุจูุงูุงุช

```bash
python setup_index.py
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:

- ุฅูุดุงุก ููุฑุณ Elasticsearch
- ููุฑุณุฉ ุฌููุน ุขูุงุช ุงููุฑุขู
- ุชูููุฏ embeddings ููุจุญุซ ุงูุฏูุงูู
- ุงูุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ

### ุงูุฎุทูุฉ 8: ุชุดุบูู ุงูุชุทุจูู

```bash
python app.py
```

ุงูุชุญ ุงููุชุตูุญ ุนูู: `http://127.0.0.1:5000`

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุงูุจุญุซ ุงูุฃุณุงุณู

- ุฃุฏุฎู ุงููุต ุงูุฐู ุชุฑูุฏ ุงูุจุญุซ ุนูู
- ุงุฎุชุฑ ููุน ุงูุจุญุซ (ูููุตุญ ุจุงูุจุญุซ ุงููุฌูู)
- ุญุฏุฏ ุนุฏุฏ ุงููุชุงุฆุฌ ุงููุทููุจุฉ
- ุงุถุบุท ุนูู "ุจุญุซ"

### 2. ุฃููุงุน ุงูุจุญุซ

#### ุงูุจุญุซ ุงููุบูู (Lexical)

ููุงุณุจ ููุจุญุซ ุนู:

- ูููุงุช ูุญุฏุฏุฉ
- ุนุจุงุฑุงุช ุฏูููุฉ
- ุฃุณูุงุก ุงูุณูุฑ

ูุซุงู: `ุงูุตูุงุฉ` - ุณูุฌุฏ ุฌููุน ุงูุขูุงุช ุงูุชู ุชุญุชูู ุนูู ูููุฉ "ุงูุตูุงุฉ"

#### ุงูุจุญุซ ุงูุฏูุงูู (Semantic)

ููุงุณุจ ููุจุญุซ ุนู:

- ููุงููู ููุนุงูู
- ููุงุถูุน
- ุฃุณุฆูุฉ

ูุซุงู: `ุงูุตุจุฑ ุนูู ุงููุตุงุฆุจ` - ุณูุฌุฏ ุขูุงุช ุชุชุญุฏุซ ุนู ุงูุตุจุฑ ุญุชู ูู ูู ุชุญุชูู ุนูู ูุฐู ุงููููุงุช ุจุงูุถุจุท

#### ุงูุจุญุซ ุงููุฌูู (Hybrid) - ุงูููุตู ุจู

ูุฌูุน ุจูู ูููุฒุงุช ุงูููุนูู ุงูุณุงุจููู ููุญุตูู ุนูู ุฃูุถู ุงููุชุงุฆุฌ.

### 3. ููู ุงููุชุงุฆุฌ

ูู ูุชูุฌุฉ ุชุนุฑุถ:

- **ุงุณู ุงูุณูุฑุฉ ูุฑูููุง**
- **ุฑูู ุงูุขูุฉ**
- **ูุต ุงูุขูุฉ ูุงููุงู**
- **ุฏุฑุฌุฉ ุงูุฏูุฉ**: ูููุง ูุงูุช ุฃุนููุ ูุงูุช ุงููุชูุฌุฉ ุฃูุซุฑ ุตูุฉ

## ๐ง ุงููููุงุช ุงูุฑุฆูุณูุฉ

```
quran-search-app/
โโโ app.py                      # ุชุทุจูู Flask ุงูุฑุฆูุณู
โโโ quran_search_backend.py     # ููุทู ุงูุจุญุซ ูุงูุงุชุตุงู ุจู ES
โโโ index_mapping.py            # ุชุนุฑูู ุจููุฉ ุงูููุฑุณ
โโโ setup_index.py              # ุณูุฑูุจุช ุงูุฅุนุฏุงุฏ
โโโ prepare_quran_data.py       # ุชุญุถูุฑ ุงูุจูุงูุงุช ูู XML
โโโ requirements.txt            # ุงููุชุทูุจุงุช ุงูุจุฑูุฌูุฉ
โโโ .env                        # ูุชุบูุฑุงุช ุงูุจูุฆุฉ (ูุง ุชุดุงุฑูู!)
โโโ quran_data.csv             # ุจูุงูุงุช ุงููุฑุขู
โโโ templates/
โ   โโโ index.html             # ูุงุฌูุฉ ุงููุณุชุฎุฏู
โโโ README.md                  # ูุฐุง ุงูููู
```

## ๐ API Endpoints

### ุงูุจุญุซ

```
POST /api/search
Content-Type: application/json

{
 "query": "ูุต ุงูุจุญุซ",
 "search_type": "hybrid|lexical|semantic",
 "top_k": 10
}
```

**Response:**

```json
{
 "success": true,
 "results": [
 {
 "sura": 1,
 "aya": 1,
 "text": "ุจูุณููู ุงูููููู ุงูุฑููุญูููููฐูู ุงูุฑููุญูููู",
 "sura_name": "ุงููุงุชุญุฉ",
 "score": 15.234
 }
 ],
 "count": 10,
 "query": "ูุต ุงูุจุญุซ",
 "search_type": "hybrid"
}
```

### ูุญุต ุงูุญุงูุฉ

```
GET /api/health
```

### ุงูุฅุญุตุงุฆูุงุช

```
GET /api/stats
```

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ูุดููุฉ: ูุดู ุงูุงุชุตุงู ุจู Elasticsearch

**ุงูุญู:**

1. ุชุฃูุฏ ูู ุชุดุบูู Elasticsearch: `curl localhost:9200`
2. ุชุญูู ูู ุฅุนุฏุงุฏุงุช `.env`
3. ุชุฃูุฏ ูู ูููุฉ ุงููุฑูุฑ ุงูุตุญูุญุฉ

### ูุดููุฉ: ุจุทุก ุงูุจุญุซ ุงูุฏูุงูู

**ุงูุญู:**

1. ุงููููุฐุฌ ููุญููู ุนูุฏ ุฃูู ุงุณุชุฎุฏุงู (ูุฏ ูุฃุฎุฐ ููุชุงู)
2. ุชุฃูุฏ ูู ูุฌูุฏ ุฐุงูุฑุฉ ูุงููุฉ (4GB+ ูููุตุญ ุจูุง)
3. ุงุณุชุฎุฏู ูููุฐุฌ ุฃุตุบุฑ ูู `quran_search_backend.py`

### ูุดููุฉ: ูุง ุชุธูุฑ ุงููุชุงุฆุฌ

**ุงูุญู:**

1. ุชุฃูุฏ ูู ุชุดุบูู `setup_index.py` ุฃููุงู
2. ุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช: `GET /api/stats`
3. ุฑุงุฌุน ุณุฌูุงุช ุงูุฃุฎุทุงุก ูู terminal

## ๐ ุงููุดุฑ ูู ุงูุฅูุชุงุฌ

### ุงุณุชุฎุฏุงู Gunicorn

```bash
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

### ุงุณุชุฎุฏุงู Docker (ูุฑูุจุงู)

ุณูุชู ุฅุถุงูุฉ Dockerfile ูุฑูุจุงู ูููุดุฑ ุงูุณูู.

## ๐ ุฃูุงู ุงูุฅูุชุงุฌ

โ๏ธ **ููู ููุฅูุชุงุฌ:**

1. **ุงุณุชุฎุฏู HTTPS** ูุชุดููุฑ ุงูุงุชุตุงู
2. **ูุนูู ุงููุตุงุฏูุฉ** ุนูู Elasticsearch
3. **ุงุณุชุฎุฏู ุดูุงุฏุงุช SSL ุตุงูุญุฉ**
4. **ุฃุฒู `verify_certs=False`** ูู ุงูููุฏ
5. **ูุง ุชุดุงุฑู ููู `.env`**
6. **ุงุณุชุฎุฏู ูููุงุช ูุฑูุฑ ูููุฉ**

## ๐ ุชุญุณููุงุช ูุณุชูุจููุฉ

- [ ] ุฅุถุงูุฉ ุฏุนู ุงูุชุฑุฌูุฉ ุงูุฅูุฌููุฒูุฉ ูู ุงูุจุญุซ
- [ ] ุฅุถุงูุฉ ุงูุจุญุซ ุจุงูุฌุฐูุฑ ุงููุบููุฉ (lemma)
- [ ] ุฅุถุงูุฉ ููุงุชุฑ (ุจุงูุณูุฑุฉุ ุงูุฌุฒุกุ ุงูุตูุญุฉ)
- [ ] ุฅุถุงูุฉ ุชุตุฏูุฑ ุงููุชุงุฆุฌ
- [ ] ุฅุถุงูุฉ ุญูุธ ุนูููุงุช ุงูุจุญุซ ุงูููุถูุฉ
- [ ] ุฏุนู ุชุดุบูู ุงูุชูุงูุฉ ุงูุตูุชูุฉ
- [ ] ุฅุถุงูุฉ ุงูุชูุณูุฑ

## ๐ค ุงููุณุงููุฉ

ุงููุณุงููุงุช ูุฑุญุจ ุจูุง! ูุฑุฌู:

1. Fork ุงููุดุฑูุน
2. ุฅูุดุงุก branch ุฌุฏูุฏ (`git checkout -b feature/amazing-feature`)
3. Commit ุงูุชุบููุฑุงุช (`git commit -m 'Add amazing feature'`)
4. Push ููู branch (`git push origin feature/amazing-feature`)
5. ูุชุญ Pull Request

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ููุชูุญ ุงููุตุฏุฑ ููุชุงุญ ููุงุณุชุฎุฏุงู ุงูุชุนูููู ูุงูุดุฎุตู.

## ๐ฅ ุงููุทูุฑูู

ุชู ุชุทููุฑู ุจูุงุณุทุฉ ูุฑูู ุงูุชุทููุฑ - ุฅุฐุง ุฃุนุฌุจู ุงููุดุฑูุนุ ูุง ุชูุณู ุฅุนุทุงุกู โญ

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. ุชุญูู ูู ูุณู ุญู ุงููุดุงูู ุฃุนูุงู
2. ุงุจุญุซ ูู Issues ุงูููุฌูุฏุฉ
3. ุงูุชุญ Issue ุฌุฏูุฏ ูุน ุชูุงุตูู ุงููุดููุฉ

---

ุจุงูุชุฃููุฏุ ุฅููู ููู ููุงุญุธุฉ (README/ูุณุชูุฏ ุชูุซููู) ุงุญุชุฑุงูู ููุซู ูุตุฏุฑ ุงูุจูุงูุงุช ูุทุฑููุฉ ุชุญููููุง.

---

# ุชูุซูู ูุตุฏุฑ ุงูุจูุงูุงุช ูุชุญุถูุฑูุง

## ๐ ูุธุฑุฉ ุนุงูุฉ

ููุซูู ูุฐุง ุงููุณุชูุฏ ูุตุฏุฑ ุงูุจูุงูุงุช ุงููุฑุขููุฉ ุงููุณุชุฎุฏูุฉ ูู ูุฐุง ุงููุดุฑูุน ูุงูุฎุทูุงุช ุงููุชุจุนุฉ ูุชุญููููุง ูู ุตูุบุฉ XML ุฅูู ุตูุบุฉ CSVุ ููุง ูุณูู ูุนุงูุฌุชูุง ูุงุณุชุฎุฏุงููุง ูู ุงูุชุทุจููุงุช ุงูุชุญููููุฉ ูุงูุจุฑูุฌูุฉ.

---

## ๐พ ูุตุฏุฑ ุงูุจูุงูุงุช ุงููุฑุขููุฉ

ุชู ุงุณุชุฎุฏุงู ููู ุงูุจูุงูุงุช ุงููุตูุฉ ุงูุจุณูุท ูููุฑุขู ุงููุฑูู (ุจุฏูู ุชุดููู)ุ ููู ุงูููู ุงูููุณูู **`quran-simple-plain.xml`**.

- **ุงููุตุฏุฑ:** ูููุน ุชูุฒูู (Tanzil.net).
- **ุฑุงุจุท ุงูุชุญููู:** [https://tanzil.net/download/](https://tanzil.net/download/)
- **ุงูุชุฑุฎูุต:** ููุฑุฌู ูุฑุงุฌุนุฉ ุดุฑูุท ุงุณุชุฎุฏุงู ูููุน ุชูุฒูู ููุจูุงูุงุช ุงูุฎุงุตุฉ ุจูู.

---

## ๐๏ธ ุนูููุฉ ุชุญููู ุงูุจูุงูุงุช (XML ุฅูู CSV)

ุชู ุชุญููู ููู ุงูุจูุงูุงุช **`quran-simple-plain.xml`** ุฅูู ููู ุจุตูุบุฉ CSV ูููุธููุฉุ ููู ุงูููู ุงูููุณูู **`quran_data.csv`**ุ ุจุงุณุชุฎุฏุงู ุงูุณูุฑุจุช ุงููุฎุตุต **`prepare_quran_data.py`** ุงูููุถุญ ุฃุฏูุงู.

### ๐ ุณูุฑุจุช ุงูุชุญููู: `prepare_quran_data.py`

ูุณุชุฎุฏู ุงูุณูุฑุจุช ููุชุจุชู `xml.etree.ElementTree` ููุนุงูุฌุฉ XML ู `pandas` ูุชูููู ูุฅุฎุฑุงุฌ ููู CSV.

```python
import xml.etree.ElementTree as ET
import pandas as pd
import re

def remove_arabic_diacritics(text):
 """ุฅุฒุงูุฉ ุงูุชุดููู ูู ุงููุต ุงูุนุฑุจู"""
 if not text:
  return ""
 # ููุณุชุฎุฏู ูุฐุง ุงููุงููุดู ูุฅุฒุงูุฉ ุนูุงูุงุช ุงูุชุดูููุ ููููู ุบูุฑ ูููุนูู ูู ุงูุฅุฎุฑุงุฌ ุงูุญุงูู ููู CSV.
 return re.sub(r'[\u064b-\u0652\u0670]', '', text)

def generate_csv_from_xml(xml_file_path="data/quran-simple-plain.xml", output_csv_path="quran_data.csv"):
 """
 ูููู ุจุชุญููู ุงูุจูุงูุงุช ูู ููู XML ุฅูู DataFrame ููู ุซู ุฅูู ููู CSV.
 """
 tree = ET.parse(xml_file_path)
 root = tree.getroot()

 records = []
 for sura in root.findall('sura'):
  sura_index = int(sura.get('index'))
  sura_name = sura.get('name')

  for aya in sura.findall('aya'):
   aya_index = int(aya.get('index'))
   text = aya.get('text')
   bismillah = aya.get('bismillah', '') # ูุงูุชูุงุท ุงูุจุณููุฉ ุฅู ูุฌุฏุช ูุฎุงุตูุฉ ูููุตูุฉ

   record = {
     "sura": sura_index,
     "aya": aya_index,
     "text": text,
     "sura_name": sura_name,
     # ูููู ุฅุถุงูุฉ ุญููู ุฃุฎุฑู ููุง ูู ุญุงู ุฅุถุงูุฉ ุจูุงูุงุช ุฅุถุงููุฉ (ูุซู ุงูุชุฑุฌูุฉุ ุงูุฌุฒุฑ ุงููุบููุฉุ ุฅูุฎ.)
   }
   records.append(record)

 df = pd.DataFrame(records)
 # ูุชู ุชุตุฏูุฑ ุงูุจูุงูุงุช ุฅูู ููู CSV ุจุงุณุชุฎุฏุงู ุชุฑููุฒ 'utf-8-sig' ูุถูุงู ุงูุชุนุงูู ุงูุณููู ูุน ุงูุญุฑูู ุงูุนุฑุจูุฉ.
 df.to_csv(output_csv_path, index=False, encoding='utf-8-sig')
 print(f"โ ุชู ุฅูุดุงุก ููู CSV ุจูุฌุงุญ ูู: {output_csv_path}")

if __name__ == "__main__":
 # ูููุชุฑุถ ุฃู ุงูููู ุงูุฃุตูู ููุฌูุฏ ูู ุงููุณุงุฑ "data/quran-simple-plain.xml"
 generate_csv_from_xml()
```

### ๐ ุญููู ููู ุงูู CSV ุงููุงุชุฌ

ูุญุชูู ููู **`quran_data.csv`** ุนูู ุงูุฃุนูุฏุฉ ุงูุชุงููุฉ:

| ุงูุนููุฏ          | ุงููุตู                           | ููุน ุงูุจูุงูุงุช |
| :-------------- | :------------------------------ | :----------- |
| **`sura`**      | ุฑูู ุงูุณูุฑุฉ (ุงูููุฑุณ)             | ุนุฏุฏ ุตุญูุญ     |
| **`aya`**       | ุฑูู ุงูุขูุฉ ุถูู ุงูุณูุฑุฉ (ุงูููุฑุณ)   | ุนุฏุฏ ุตุญูุญ     |
| **`text`**      | ุงููุต ุงููุฑุขูู ููุขูุฉ (ุจุฏูู ุชุดููู) | ูุต (String)  |
| **`sura_name`** | ุงุณู ุงูุณูุฑุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ       | ูุต (String)  |

ูุฐุง ุงูุชูุณูู ุงููููุธููู ูุชูุญ ุณูููุฉ ุงูุจุญุซุ ุงูููุฑุณุฉุ ูุงูุฑุจุท ูุน ุฃู ูุตุงุฏุฑ ุจูุงูุงุช ุฃุฎุฑู.

